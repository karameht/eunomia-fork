#!/usr/bin/env sh

echo "ğŸ“ EUNOMIA Commit Message Validation"
echo "===================================="

# Read commit message from file
commit_msg=$(cat "$1")

# Check minimum length
if [ ${#commit_msg} -lt 10 ]; then
  echo "âŒ Commit message too short! Minimum 10 characters required."
  echo "ğŸ’¡ Your message: '$commit_msg'"
  echo "ğŸ’¡ Example: 'feat: add accessibility tooling'"
  exit 1
fi

# Check conventional commits format (optional but recommended)
if ! echo "$commit_msg" | grep -qE "^(feat|fix|docs|style|refactor|test|chore|perf|ci|build)(\(.+\))?: .+"; then
  echo "âš ï¸  Warning: Consider using conventional commits format:"
  echo "ğŸ’¡ feat: add new feature"
  echo "ğŸ’¡ fix: bug fix"
  echo "ğŸ’¡ docs: documentation update"
  echo "ğŸ’¡ refactor: code refactoring"
  echo "ğŸ’¡ Current message: '$commit_msg'"
  echo ""
  echo "ğŸ¤” Continue anyway? (y/N)"
  read -r response
  if [ "$response" != "y" ] && [ "$response" != "Y" ]; then
    echo "âŒ Commit cancelled. Please update your commit message."
    exit 1
  fi
fi

echo "âœ… Commit message validated!"
echo "===================================="
